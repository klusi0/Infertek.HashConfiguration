//Infertek.HashConfiguration v0.1.1 | (c) 2012 Tomasz Miku≈õ | http://www.opensource.org/licenses/mit-license
(function(e,t){e.Infertek||(e.Infertek={}),e.Infertek.HashConfiguration=function(n,r){var i="excludeFromHashConfiguration",s=/^(\d{4})-(\d{1,2})-(\d{1,2})\s(\d{1,2}):(\d{1,2}):(\d{1,2})$/gi,o=function(){if(location.hash=="")return null;var e=location.hash.substr(1).split("&"),t={};for(var n=0;n<e.length;n++){var r=e[n].split("=");if(r.length!=2)continue;t[decodeURI(r[0])]=decodeURI(r[1])}return t},u=function(){var t="";for(var r in n){var s=n[r];if(s&&s[i])continue;if(ko.isObservable(s)&&!s.pop&&!s.push||ko.isComputed(s))s=s();else if(typeof s=="function")continue;Object.prototype.toString.call(s)=="[object Date]"&&(s=s.format("yyyy-M-d h:m:s"));if(!s||s==="")continue;t&&(t+="&"),t+=encodeURI(r),t+="=",s&&(t+=encodeURI(s))}e.Infertek.HashConfiguration.isUpdatingHash=!0,location.hash=t,e.Infertek.HashConfiguration.isUpdatingHash=!1},a=function(){if(e.Infertek.HashConfiguration.isUpdatingHash)return;var r=o();if(r)for(var u in r){if(n[u]===t||n[u][i])continue;var a=r[u];s.lastIndex=0;var f=s.exec(a);f!=null&&(a=new Date(parseInt(f[1]),parseInt(f[2])-1,parseInt(f[3]),parseInt(f[4]),parseInt(f[5]),parseInt(f[6])));if(ko.isObservable(n[u])&&!n[u].pop&&!n[u].push||ko.isComputed(n[u]))n[u](a);else{if(typeof n[u]=="function")continue;n[u]=a}}};a();if(r)for(var f in n){var l=n[f];if(!l||l[i])continue;(ko.isObservable(l)&&!l.pop&&!l.push||ko.isComputed(l))&&l.subscribe(function(){u()})}$(e).on("hashchange",a),this.updateHash=u},e.Infertek.HashConfiguration.excludeFromHash=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t].excludeFromHashConfiguration=!0;else e.excludeFromHashConfiguration=!0},Array.isArray||(Array.isArray=function(e){return e instanceof Array}),e.Infertek.HashConfiguration.isUpdatingHash=!1})(window,undefined)